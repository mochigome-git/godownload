# Environment (development or production)
ENV=production

# Server port (for local development)
PORT=8081

# Supabase Configuration
SUPABASE_URL=
SUPABASE_SERVICE_KEY=
SUPABASE_ANON_KEY=


# Supabase Storage Configuration
SUPABASE_STORAGE_BUCKET=exports
SUPABASE_STORAGE_EXPORT_PATH=exports/
SUPABASE_STORAGE_EXPIRY_HOURS=24


# Database (Optional - for direct connection)
SUPABASE_DB_HOST=db.your-project.supabase.co
SUPABASE_DB_PORT=5432
SUPABASE_DB_USER=postgres
SUPABASE_DB_PASSWORD=your-db-password
SUPABASE_DB_NAME=postgres

# =============================================================================
# DATA TRANSFORMATION CONFIG
# =============================================================================

# JOIN_MAPPINGS - Replace foreign keys with display values from related tables
#
# Format (with explicit foreign key):
#   schema.table.column:foreign_schema.foreign_table.foreign_key.display_column:output_name
#
# Format (foreign key defaults to "id"):
#   schema.table.column:foreign_schema.foreign_table.display_column:output_name
#
# Your mappings:
# - machine_id -> production.machine_list.id -> get "name" column -> output as "machine_name"
# - device_id -> device.device_list.id -> get "name" column -> output as "device_name"
# - lot_id -> production.lot.id -> get "lot_number" column -> output as "lot_number"

JOIN_MAPPINGS=analytics.realtime_metrics.machine_id:production.machine_list.id.name:machine_name,analytics.realtime_metrics.device_id:device.device_list.id.name:device_name,analytics.realtime_metrics.lot_id:production.lot.id.lot_number:lot_number

# HIDDEN_COLUMNS - Columns to exclude from output
# NOTE: Do NOT include machine_id, device_id, lot_id here!
# The transformer already removes FK columns after joining them to display values.
# Only list columns you want completely hidden (not replaced with joins).
HIDDEN_COLUMNS=analytics.realtime_metrics.tenant_id,analytics.realtime_metrics.entity_id

# FLATTEN_JSONB - JSONB columns to flatten (extract keys as separate columns)
FLATTEN_JSONB=analytics.realtime_metrics.data